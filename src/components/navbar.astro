---
// Navbar.astro
import { Image } from 'astro:assets';
import logito from '../assets/images/logito.webp';
---

<nav
  class="fixed top-0 left-0 w-full z-[1000] backdrop-blur-2xl bg-black/20 border-b border-white/5 transition-all duration-500"
  id="mainNav"
>
  <div
    class="max-w-7xl mx-auto px-6 sm:px-10 lg:px-12 py-6 flex justify-between items-center"
  >
    <a
      href="/"
      class="transition-transform duration-500 hover:scale-110 flex items-center gap-3"
    >
      <Image
        src={logito}
        alt="Logo Julian Rpo Trainer"
        class="h-8 md:h-10 w-auto brightness-110"
        loading="eager"
        width={128}
        height={80}
      />
      <span
        class="text-white font-black tracking-[0.3em] text-xs hidden sm:block uppercase italic"
        >Julian Rpo</span
      >
    </a>

    <button
      class="menu-toggle relative w-10 h-10 flex flex-col justify-center items-center gap-1.5 md:hidden group z-[1001]"
      aria-label="Toggle menu"
    >
      <span
        class="w-6 h-0.5 bg-white transition-all duration-300 group-hover:bg-[#aba070]"
      ></span>
      <span
        class="w-6 h-0.5 bg-white transition-all duration-300 group-hover:bg-[#aba070]"
      ></span>
      <span
        class="w-4 h-0.5 bg-white transition-all duration-300 self-end mr-2 group-hover:bg-[#aba070]"
      ></span>
    </button>

    <ul
      class="nav-menu hidden md:flex items-center gap-10 list-none m-0 p-0 text-[10px] font-black tracking-[0.2em] uppercase text-white"
    >
      {
        [
          { label: "Inicio", href: "/" },
          { label: "Sobre mí", href: "/about" },
          { label: "Propósito", href: "/purpose" },
          { label: "Metodología", href: "/metodologia" },
          { label: "Planes", href: "/plans" },
          { label: "Testimonios", href: "/testimonies" },
          { label: "E-Books", href: "/ebooks" },
          { label: "Contacto", href: "/contact" },
        ].map((item) => {
          return (
            <li class="relative">
              <a
                href={item.href}
                class="hover:text-[#aba070] transition-all duration-300 group inline-block"
              >
                {item.label}
                <span class="absolute -bottom-2 left-0 w-0 h-[2px] bg-[#aba070] transition-all duration-500 group-hover:w-full opacity-50 shadow-[0_0_8px_#aba070]" />
              </a>
            </li>
          );
        })
      }
    </ul>

    <!-- Mobile Menu Overlay -->
    <div
      class="nav-overlay fixed inset-0 bg-black backdrop-blur-3xl z-[999] opacity-0 pointer-events-none transition-all duration-700 flex flex-col items-center justify-start overflow-y-auto pt-32 pb-20 md:hidden h-[100dvh]"
    >
      <div class="absolute top-0 right-0 p-8">
        <div class="w-32 h-32 bg-[#aba070]/10 blur-3xl rounded-full"></div>
      </div>

      <ul
        class="flex flex-col items-center gap-8 text-2xl text-white font-black tracking-tighter uppercase italic text-center"
      >
        {
          [
            { label: "Inicio", href: "/" },
            { label: "Sobre mí", href: "/about" },
            { label: "Propósito", href: "/purpose" },
            { label: "Metodología", href: "/metodologia" },
            { label: "Planes", href: "/plans" },
            { label: "Testimonios", href: "/testimonies" },
            { label: "E-Books", href: "/ebooks" },
            { label: "Contacto", href: "/contact" },
          ].map((item, index) => {
            return (
              <li class="transform translate-y-10 opacity-0 transition-all duration-700 nav-item w-full">
                <a
                  href={item.href}
                  class="hover:text-[#aba070] transition-colors block w-full py-2"
                >
                  {item.label}
                </a>
              </li>
            );
          })
        }
      </ul>
    </div>
  </div>
</nav>

<script>
  const menuToggle = document.querySelector(".menu-toggle");
  const navOverlay = document.querySelector(".nav-overlay");
  const navItems = document.querySelectorAll(".nav-item");
  const spans = menuToggle?.querySelectorAll("span");
  const nav = document.getElementById("mainNav");

  // Scroll effect
  window.addEventListener("scroll", () => {
    if (window.scrollY > 50) {
      nav?.classList.add("bg-black/60", "py-4", "border-b", "border-white/10");
      nav?.classList.remove("bg-black/20", "py-6", "border-white/5");
    } else {
      nav?.classList.add("bg-black/20", "py-6", "border-white/5");
      nav?.classList.remove(
        "bg-black/60",
        "py-4",
        "border-b",
        "border-white/10",
      );
    }
  });

  menuToggle?.addEventListener("click", () => {
    const isActive = navOverlay?.classList.contains("opacity-100");

    if (isActive) {
      navOverlay?.classList.remove("opacity-100", "pointer-events-auto");
      navOverlay?.classList.add("opacity-0", "pointer-events-none");
      document.body.classList.remove("overflow-hidden");
      navItems.forEach((item) => {
        item.classList.add("translate-y-10", "opacity-0");
      });
      spans?.[0].classList.remove("rotate-45", "translate-y-2");
      spans?.[1].classList.remove("opacity-0");
      spans?.[2].classList.remove("-rotate-45", "-translate-y-2", "w-6");
      spans?.[2].classList.add("w-4");
    } else {
      navOverlay?.classList.add("opacity-100", "pointer-events-auto");
      navOverlay?.classList.remove("opacity-0", "pointer-events-none");
      document.body.classList.add("overflow-hidden");
      navItems.forEach((item, i) => {
        setTimeout(() => {
          item.classList.remove("translate-y-10", "opacity-0");
        }, i * 100);
      });
      spans?.[0].classList.add("rotate-45", "translate-y-2");
      spans?.[1].classList.add("opacity-0");
      spans?.[2].classList.add("-rotate-45", "-translate-y-2", "w-6");
      spans?.[2].classList.remove("w-4");
    }
  });

  document.querySelectorAll(".nav-overlay a").forEach((link) => {
    link.addEventListener("click", () => {
      navOverlay?.classList.remove("opacity-100", "pointer-events-auto");
      navOverlay?.classList.add("opacity-0", "pointer-events-none");
      document.body.classList.remove("overflow-hidden");
    });
  });
</script>

<style>
  #mainNav {
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .nav-overlay {
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; /* IE and Edge */
  }

  .nav-overlay::-webkit-scrollbar {
    display: none; /* Chrome, Safari, Opera */
  }
</style>
